<!DOCTYPE HTML>
<html>

<head>
  <title>tfg</title>
  <meta name="description" content="website description" />
  <meta name="keywords" content="website keywords, website keywords" />
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <!--link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}style.css" /-->
 {% load staticfiles %}
<link href="{% static 'entorno/css/style.css' %}" rel="stylesheet"  type="text/css" >
 
  <!-- modernizr enables HTML5 elements and feature detects -->
  <script type="text/javascript" src="{% static 'entorno/js/modernizr-1.5.min.js' %}"></script>
 <script src="http://code.jquery.com/jquery-1.9.1.js" type="text/javascript"></script>
 <script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>

<script type="text/javascript">
function mostrar(){
document.getElementById('oculto').style.display = 'block';}
</script>

<script type="text/javascript">
function ocultar(){
document.getElementById('oculto').style.display = 'none';}
</script>

<script type="text/javascript">
function mostrar1(){
document.getElementById('oculto1').style.display = 'block';}
</script>

<script type="text/javascript">
function ocultar1(){
document.getElementById('oculto1').style.display = 'none';}
</script>



</head>

<body>
  <div id="main">
    <header>
	<div style="clear:both">
      		<div id="logo">
			<h1><a href="http://www.uam.es/ss/Satellite/es/home/"><IMG SRC="{% static 'entorno/images/logo_uam.jpg'%}" ALT="UAM" WIDTH=187 HEIGHT=82></a></h1>
		</div>

		<div align="center "id="logo2">
          		<!-- class="logo_colour", allows you to change the colour of the text -->
			<h1><strong><font color="#09D4FF" size=5 ALIGN="center"><a href="{% url 'entorno:inicio' %}" style="text-decoration:none">Entorno para la gestión de sondas de red de bajo coste</a></h1></font></strong>
         	</div>
		
		<div id="logo1"><h1><a href="http://www.uam.es/ss/Satellite/EscuelaPolitecnica/es/home.htm"><IMG SRC="{% static 'entorno/images/logo-eps1.png'%}" ALT="EPS" align="right"></a></h1>
        		
      		</div>
	</div>
      <nav>
       <div id="menu_container">
          <ul class="sf-menu" id="nav">
            <li><a href="{% url 'entorno:inicio' %}">Inicio</a></li>
	   <li><a href="{% url 'entorno:des' %}">Tipos de medidas</a></li>
            <li><a href="{% url 'entorno:des' %}">Medidas activas</a>
              <ul>
               <li><a href="{% url 'entorno:filetransfer' %}">Descarga de fichero</a></li>
                <li><a href="{% url 'entorno:packetpair' %}">Pares de paquetes</a></li>
                <li><a href="{% url 'entorno:packettrain' %}">Tren de paquetes</a></li>
               </ul>  
            </li>
            <li><a href="{% url 'entorno:des' %}">Medidas pasivas</a>
              <ul>
                <li><a href="{% url 'entorno:flujos' %}">Flujos</a></li>
             	<li><a href="{% url 'entorno:mrtg' %}">MRTG</a></li>
               </ul>  
             </li>
             
             <!--li><a href="{% url 'entorno:sondas' %}">Sondas</a></li-->
            
            
            </ul> 
             
        </div>
      </nav>
    </header>
     <div id="site_content">
      <div id="sidebar_container">

        <div class="sidebar">
		<div style="text-align:left;width:350px;padding:0.5em 0;"> <h2><a style="text-decoration:none;" href="http://www.zeitverschiebung.net/es/city/3117735"><span style="color:gray;">Hora actual en</span><br />Madrid, Spain</a></h2> <iframe src="http://www.zeitverschiebung.net/clock-widget-iframe?language=es&timezone=Europe%2FMadrid" width="65%" height="120" frameborder="0" seamless></iframe> <small style="text-align:left;color:gray;"> <a href="http://www.zeitverschiebung.net/es/" style="text-align:left;color: gray;"></a></small> </div>	
	</div>
        <div class="sidebar">
          <h4>Links de interes.</h4>
          <ul>
            <li><a href="http://www.uam.es/ss/Satellite/es/home/">UAM</a></li>
            <li><a href="http://www.uam.es/ss/Satellite/EscuelaPolitecnica/es/home.htm">Escuela Politecnica superior</a></li>
           
          </ul>
	 </div>
	
       
      </div>
      <div class="content">
        <h1>Monitorización Flujos</h1>
        <p align="justify">El nivel de flujos de monotorización utiliza NetFlow/IPFIX  para exportar información de routers o switches para estimar de cada uno sus párametros de calidad de servicio o hacer hipótesis sobre el estado y rendimiento de la red monotorizada.</p>
        <p align="justify">Se intentara obtener los párametros de calidad de servicio usando la mínima informacion proveniente de cada NetFlow basado en flujos o simplemente flujos IPFIX. A la estimación pasiva de ancho de banda no se le dara mucha importancia, ya que, analizando el ancho de banda monotorizando paquetes se consiguen errores mas pequeños en la estimación. </p>
       
      </div>
    </div>
 <div class="form_settings">
 <input class="submit" type="button" value="Mostrar QoS" onclick="mostrar()">
 <input  class="submit" type="button"value="Ocultar QoS" onclick="ocultar()">
 </div>
 <div id='oculto' style='display:none;'> 



    {% if x %}
    	<p><h2><font size=5> Parámetros de calidad de servicio utilizando el método:<i> Monotorización por flujos.</i></h2></font><p>
    	<table class=tabla1 >
		<tr>
		<td > Id</td>
		<td width=130> IP Origen</td>
		<td width=130> IP Destino</td>
		<td width=10> Puerto Origen</td>
		<td> Puerto Destino</td>
		<td> Protocolo de transporte</td>
		<td> Numero de bytes</td>
		<td> Numero de paquetes</td>
		<td width=160> Tiempo de inicio</td>
		<td width=160> Tiempo de fin</td>
       </tr></table>
	<div class=tabla style="min-width: 400px; height: 400px; margin: 0 auto; overflow-y:scroll">
	<table class=tabla>

     	{% for question in x %}
		<tr>
		<td  width=5>{{question.id}}</td>
		<td width=70>{{question.ip_origen}}</td>
		<td width=100>{{question.ip_destino}}</td>
		<td width=55>{{question.puerto_origen}}</td>
		<td width=60>{{question.puerto_destino}}</td>
		<td width=70>{{question.protocolo_transporte}}</td>
		<td width=65>{{question.numero_bytes}}</td>
		<td width=55>{{question.numero_paquetes}}</td>
        	<td width=5>{{question.tiempo_inicio}}</td>
		<td width=5>{{question.tiempo_fin}}</td>
		</tr>

    	{% endfor %}
    		</table></div>
        

    {% else %}
    <p>No hay disponibles párametros de calidad de servicio.</p>
    {% endif %}
    </div>
<div class="form_settings">
    <form  action="{% url 'entorno:formflujos' %}" autocomplete="on"  method="post">
            {% csrf_token %}
	     <p><span>Selecionar el campo deseado</span> <select name="seleccion" id="seleccion">
            <option value="1">Número de bytes</option>
            <option value="2">Número de paquetes</option></select></p>
	   
	    
            <h2>Filtrar gráfico por:</h2> 
	      <p>Dejar el campo en blanco si no se desea filtrar por este.</p>
              <p> 
                <label for="ip_origen" ><b> IP origen:</b></label>
                <input id="ip_origen" name="ip_origen" type="text" placeholder="000.000.0.0"/>
              </p>
              <p> 
                <label for="ip_destino"><b>IP destino:</b> </label>
                <input id="ip_destino" name="ip_destino" type="text" placeholder="000.000.0.0" /> 
              </p>
              <p> 
                <label for="puerto_origen"><b> Puerto origen:</b> </label>
                <input id="puerto_origen" name="puerto_origen" type="text" placeholder="0000" /> 
              </p>
	      <p> 
                <label for="puerto_destino"><b>Puerto destino:</b> </label>
                <input id="puerto_destino" name="puerto_destino" type="text" placeholder="0000" /> 
              </p>                 
             <input type="submit" class="submit" value="Generar gráfico" onclick="capturar()"> 
     </form>
   
   </div>

     

 

{% if p %} 
<div id="resultado"></div> 
 <script type="text/javascript">

 	
$(function plotTimes() {
// Load the fonts
Highcharts.createElement('link', {
   href: '//fonts.googleapis.com/css?family=Unica+One',
   rel: 'stylesheet',
   type: 'text/css'
}, null, document.getElementsByTagName('head')[0]);

Highcharts.theme = {
   colors: ["#2b908f", "#90ee7e", "#f45b5b", "#7798BF", "#aaeeee", "#ff0066", "#eeaaee",
      "#55BF3B", "#DF5353", "#7798BF", "#aaeeee"],
   chart: {
      backgroundColor: {
         linearGradient: { x1: 0, y1: 0, x2: 1, y2: 1 },
         stops: [
            [0, '#2a2a2b'],
            [1, '#3e3e40']
         ]
      },
      style: {
         fontFamily: "'Unica One', sans-serif"
      },
      plotBorderColor: '#606063'
   },
   title: {
      style: {
         color: '#E0E0E3',
         textTransform: 'uppercase',
         fontSize: '20px'
      }
   },
   subtitle: {
      style: {
         color: '#E0E0E3',
         textTransform: 'uppercase'
      }
   },
   xAxis: {
      gridLineColor: '#707073',
      labels: {
         style: {
            color: '#E0E0E3'
         }
      },
      lineColor: '#707073',
      minorGridLineColor: '#505053',
      tickColor: '#707073',
      title: {
         style: {
            color: '#A0A0A3'

         }
      }
   },
   yAxis: {
      gridLineColor: '#707073',
      labels: {
         style: {
            color: '#E0E0E3'
         }
      },
      lineColor: '#707073',
      minorGridLineColor: '#505053',
      tickColor: '#707073',
      tickWidth: 1,
      title: {
         style: {
            color: '#A0A0A3'
         }
      }
   },
   tooltip: {
      backgroundColor: 'rgba(0, 0, 0, 0.85)',
      style: {
         color: '#F0F0F0'
      }
   },
   plotOptions: {
      series: {
         dataLabels: {
            color: '#B0B0B3'
         },
         marker: {
            lineColor: '#333'
         }
      },
      boxplot: {
         fillColor: '#505053'
      },
      candlestick: {
         lineColor: 'white'
      },
      errorbar: {
         color: 'white'
      }
   },
   legend: {
      itemStyle: {
         color: '#E0E0E3'
      },
      itemHoverStyle: {
         color: '#FFF'
      },
      itemHiddenStyle: {
         color: '#606063'
      }
   },
   credits: {
      style: {
         color: '#666'
      }
   },
   labels: {
      style: {
         color: '#707073'
      }
   },

   drilldown: {
      activeAxisLabelStyle: {
         color: '#F0F0F3'
      },
      activeDataLabelStyle: {
         color: '#F0F0F3'
      }
   },

   navigation: {
      buttonOptions: {
         symbolStroke: '#DDDDDD',
         theme: {
            fill: '#505053'
         }
      }
   },

   // scroll charts
   rangeSelector: {
      buttonTheme: {
         fill: '#505053',
         stroke: '#000000',
         style: {
            color: '#CCC'
         },
         states: {
            hover: {
               fill: '#707073',
               stroke: '#000000',
               style: {
                  color: 'white'
               }
            },
            select: {
               fill: '#000003',
               stroke: '#000000',
               style: {
                  color: 'white'
               }
            }
         }
      },
      inputBoxBorderColor: '#505053',
      inputStyle: {
         backgroundColor: '#333',
         color: 'silver'
      },
      labelStyle: {
         color: 'silver'
      }
   },

   navigator: {
      handles: {
         backgroundColor: '#666',
         borderColor: '#AAA'
      },
      outlineColor: '#CCC',
      maskFill: 'rgba(255,255,255,0.1)',
      series: {
         color: '#7798BF',
         lineColor: '#A6C7ED'
      },
      xAxis: {
         gridLineColor: '#505053'
      }
   },

   scrollbar: {
      barBackgroundColor: '#808083',
      barBorderColor: '#808083',
      buttonArrowColor: '#CCC',
      buttonBackgroundColor: '#606063',
      buttonBorderColor: '#606063',
      rifleColor: '#FFF',
      trackBackgroundColor: '#404043',
      trackBorderColor: '#404043'
   },

   // special colors for some of the
   legendBackgroundColor: 'rgba(0, 0, 0, 0.5)',
   background2: '#505053',
   dataLabelsColor: '#B0B0B3',
   textColor: '#C0C0C0',
   contrastTextColor: '#F0F0F3',
   maskColor: 'rgba(255,255,255,0.3)'
};

// Apply the theme
Highcharts.setOptions(Highcharts.theme);
    $('#container').highcharts({
        chart: {
            zoomType: 'x'
        },
        title: {
            text: 'Monotorización de flujos'
        },
        subtitle: {
            text: document.ontouchstart === undefined ?
                    'Click en un área para hacer zoom' :
                    'Click en un área para hacer zoom'
        },
        xAxis: {
            type: 'datetime',
            minRange: 3600*24*10 // fourteen days
        },
        yAxis: {
            title: {
		{% if w == 1 %}
		                text: 'Numero de bytes'
		 {% else %}
				 text: 'Numero de paquetes'
		{% endif %}
            }
        },
        legend: {
            enabled: false
        },
        plotOptions: {
            area: {
                fillColor: {
                    linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1},
                    stops: [
                        [0, Highcharts.getOptions().colors[0]],
                        [1, Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get('rgba')]
                    ]
                },
                marker: {
                    radius: 2
                },
                lineWidth: 1,
                states: {
                    hover: {
                        lineWidth: 1
                    }
                },
                threshold: null
            }
        },

        series: [{
            type: 'area',
	    {% if w == 1 %}
		                name: 'Numero de bytes',
		 {% else %}
				 name: 'Numero de paquetes',
		{% endif %}
            
            pointInterval: 300000,
            pointStart: Date.UTC(2006, 0, 1),
	    data: [
	    {% if p %}
		    	{% if w == 1 %}
		     		{% for question in p %}
					{{question.numero_bytes}},

		    		{% endfor %}
			
                        {% else %}
				{% for question in p %}
					{{question.numero_paquetes}},

		    		{% endfor %}
			{% endif %}
 	     {% endif %}
	   ]
            
        }]
    });
});

 
	
    </script>  
    {% endif %}


	
 {% if p %}
   <div id="container" style="min-width: 400px; height: 400px; margin: 0 auto"></div>    
 {% endif %}

{% if p %}

 <div class="form_settings">
 <input class="submit" type="button" value="Mostrar QoS filtrados" onclick="mostrar1()">
 <input  class="submit" type="button"value="Ocultar QoS filtrados" onclick="ocultar1()">
 </div>
 <div id='oculto1' style='display:none;'> 

 
    	<p><h2><font size=5> Parámetros de calidad de servicio utilizando el método:<i> Monotorización por flujos.(Filtrados)</i></h2></font><p>
    	<table class=tabla1 >
		<tr>
		<td > Id</td>
		<td width=130> IP Origen</td>
		<td width=130> IP Destino</td>
		<td width=10> Puerto Origen</td>
		<td> Puerto Destino</td>
		<td> Protocolo de transporte</td>
		<td> Numero de bytes</td>
		<td> Numero de paquetes</td>
		<td width=160> Tiempo de inicio</td>
		<td width=160> Tiempo de fin</td>
       </tr></table>
	<div class=tabla style="min-width: 400px; height: 400px; margin: 0 auto; overflow-y:scroll">
	<table class=tabla>

     	{% for question in p %}
		<tr>
		<td  width=5>{{question.id}}</td>
		<td width=70>{{question.ip_origen}}</td>
		<td width=100>{{question.ip_destino}}</td>
		<td width=55>{{question.puerto_origen}}</td>
		<td width=60>{{question.puerto_destino}}</td>
		<td width=70>{{question.protocolo_transporte}}</td>
		<td width=65>{{question.numero_bytes}}</td>
		<td width=55>{{question.numero_paquetes}}</td>
        	<td width=5>{{question.tiempo_inicio}}</td>
		<td width=5>{{question.tiempo_fin}}</td>
		</tr>

    	{% endfor %}
    		</table></div>
        

    {% else %}
    <p>No se ha realizado ningun filtro.</p>
    {% endif %}

 </div>

    <footer>
      <p>Copyright &copy; scenic_photo | <a href="http://www.css3templates.co.uk">design from css3templates.co.uk</a></p>
    </footer>
 </div>
  <p>&nbsp;</p>
  <!-- javascript at the bottom for fast page loading -->
  <!--script type="text/javascript" src="{% static 'entorno/js/jquery.js'%}"></script-->
  <script type="text/javascript" src="{% static 'entorno/js/jquery.easing-sooper.js'%}"></script>
  <script type="text/javascript" src="{% static 'entorno/js/jquery.sooperfish.js'%}"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      $('ul.sf-menu').sooperfish();
    });
  </script>
</body>
</html>
